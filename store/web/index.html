<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@store Demo</title>
</head>
<body>
    <div>
        <p>Count: <span id="count"></span></p>
        <p>Doubled: <span id="doubled"></span></p>
        <button id="increase">Increase</button>
        <button id="decrease">Decrease</button>
        <button id="dispose">Dispose effect</button>
        <button id="test">Test</button>
    </div>
    <script type="module">

        import { computed, effect, signal } from '../dist/index.mjs';

        const count = signal(0);
        const doubled = computed(() => count() * 2);

        const countEl = document.getElementById('count');
        const doubledEl = document.getElementById('doubled');
        const increaseBtn = document.getElementById('increase');
        const decreaseBtn = document.getElementById('decrease');
        const disposeBtn = document.getElementById('dispose');
        const testBtn = document.getElementById('test');

        const dispose = effect(() => {
            countEl.textContent = count();
            doubledEl.textContent = doubled();
        });

        increaseBtn.addEventListener('click', () => count.set(count() + 1));
        decreaseBtn.addEventListener('click', () => count.set(count() - 1));
        disposeBtn.addEventListener('click', () => dispose());

        const buggyComputed = computed(() => {
            throw new Error('Test');
        });

        const secondLayer = computed(() => {
            return buggyComputed();
        })

        testBtn.addEventListener('click', () => secondLayer());
    </script>
</body>
</html>
